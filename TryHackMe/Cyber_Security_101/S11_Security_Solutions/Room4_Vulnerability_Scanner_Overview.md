# Vulnerabilities & Patching 

## Short story (one-liner)
Vulnerabilities = small holes in your roof (weaknesses in software/hardware).  
Patching = fixing those holes so water, dust, or thieves (hackers) cannot get in.



## Easy example (house)
- Roof has tiny holes → rain enters → furniture gets damaged.  
- Fix holes (put new tiles or seal them) → house safe again.  
- In computers: missing updates or buggy programs = holes. Fixing them = patching.



## What is a vulnerability? (in one sentence)
A vulnerability is any weakness in a program or device that an attacker can use to do bad things (steal data, break the device, install malware).



## What is patching? (in one sentence)
Patching is the process of applying updates or fixes to software/hardware to remove vulnerabilities.



## Why patch quickly? (simple points)
- Prevent attackers from using the weakness.  
- Stop small problems from becoming big disasters.  
- Keep data and devices safe.



## Real-life computer example
Imagine your phone app has a secret door unlocked by mistake. A hacker finds that door and can read your messages. The app company releases a small update (patch) that locks the door. You must install the update — that is patching.



## Steps to patch a system (5 simple steps)
1. **Find** what is outdated or vulnerable.  
2. **Download** the patch/update.  
3. **Install** the patch.  
4. **Restart** device if needed.  
5. **Verify** everything works and patch applied.



## Commands (normal lines — read and try in labs)
(These are examples you can run on Ubuntu/Debian, CentOS, macOS, and Windows — each command explained below.)

Ubuntu/Debian:
sudo apt update
apt list --upgradable
sudo apt upgrade -y
uname -r
sudo reboot
sudo apt autoremove -y
sudo apt install --only-upgrade openssl

CentOS/RHEL/Fedora:
sudo yum update -y
sudo dnf upgrade -y
yum list updates

macOS:
softwareupdate -l
sudo softwareupdate -i -a
sudo reboot

Windows (PowerShell as admin):
Get-WindowsUpdate
Install-WindowsUpdate -AcceptAll -AutoReboot



## What each command does (very simple explanations)

Ubuntu/Debian:
- `sudo apt update`  
  → Ask online servers: "Any new updates available?"  
- `apt list --upgradable`  
  → Show which programs can be updated.  
- `sudo apt upgrade -y`  
  → Download and install all available updates automatically.  
- `uname -r`  
  → Show the current kernel version (important after kernel update).  
- `sudo reboot`  
  → Restart the computer so some updates take effect.  
- `sudo apt autoremove -y`  
  → Clean up old unused files.  
- `sudo apt install --only-upgrade openssl`  
  → Update just the openssl program if a newer version exists.

CentOS/RHEL/Fedora:
- `sudo yum update -y` or `sudo dnf upgrade -y`  
  → Download and install updates for the whole system.  
- `yum list updates`  
  → List available updates only.

macOS:
- `softwareupdate -l`  
  → List Apple updates available.  
- `sudo softwareupdate -i -a`  
  → Install all available Apple updates.  
- `sudo reboot`  
  → Restart Mac if required.

Windows (PowerShell):
- `Get-WindowsUpdate`  
  → Show available Windows updates (PowerShell module required).  
- `Install-WindowsUpdate -AcceptAll -AutoReboot`  
  → Install updates and allow the computer to reboot automatically.



## Quick table: vulnerability vs patching

| Thing | Vulnerability | Patching |
|---|---:|---|
| What | A weak spot (bug, missing update) | The fix (update, hotfix) |
| Effect if ignored | Hackers can enter, data loss | Protects system, closes holes |
| Example (house) | Tiny roof holes | Putting new tiles / sealing leaks |
| Who does it | Developers find or attackers exploit | Developers release patch; user installs |



## Small checklist before patching (do these)
- Backup important files.  
- Read update notes (what the patch fixes).  
- Test patch on one machine if you manage many devices.  
- Install patch during low-usage time if possible.  
- Reboot if update requests it.  
- Verify the system works after patching.



## TL;DR (short)
Treat software like your house roof. Find holes (vulnerabilities), apply fixes (patches), and keep everything updated so hackers cannot break in.

---

# Vulnerability Scanning 

## What is Vulnerability Scanning?
👉 It is the process of **checking digital systems for weaknesses** (bugs, misconfigurations, missing updates).  
👉 Just like a **doctor checking your body** for illness, scanners check systems for vulnerabilities.  

- Organizations store sensitive data (bank details, health records, etc.).  
- Hackers look for weaknesses to steal or damage that data.  
- Scanning regularly = early detection + fixing before hackers attack.  
- Some standards say: **scan quarterly (every 3 months)** or **once a year** (depending on rules).



## Why not manual scanning?
- Manual = slow, boring, and misses hidden problems.  
- Automated scanners = fast, smart, and generate reports automatically.  
- Example tools: Nessus, OpenVAS, Qualys.  
- You just give an **IP address or network range**, and the scanner will check and report.



## After scanning → Patching
Once vulnerabilities are found, organizations **fix them by applying patches** (updates or configuration changes).  
Think: *scan finds the holes → patch fills them.*



## Types of Vulnerability Scans

### 1. Authenticated vs Unauthenticated Scans

| **Authenticated Scans** | **Unauthenticated Scans** |
|--------------------------|----------------------------|
| Need host credentials (username/password). | Don’t need credentials (just IP address). |
| Show what an **insider attacker** can exploit. | Show what an **outsider attacker** can exploit. |
| Deep visibility: checks configs, installed apps, system details. | Shallow visibility: only surface-level checks. |
| Example: Scanning an internal **database** with its login. | Example: Scanning a **public website** for open ports. |

👉 Shortcut:  
- Authenticated = "insider’s view"  
- Unauthenticated = "outsider’s view"



### 2. Internal vs External Scans

| **Internal Scans** | **External Scans** |
|---------------------|---------------------|
| Run from **inside** the network. | Run from **outside** the network. |
| Focus: weaknesses attackers can use **after breaking in**. | Focus: weaknesses attackers can use **before breaking in**. |
| Example: scan company laptops, servers. | Example: scan company website, firewall. |

👉 Shortcut:  
- Internal = "inside the house check"  
- External = "outsider looking at your house from the street"



## Choosing the Scan Type
- **Internal + Authenticated** = most detailed (best for inside company systems).  
- **External + Unauthenticated** = best for checking what hackers see from the internet.  
- Many organizations use a mix of both.



## Quick Analogy (House Example 🏠)
- **Unauthenticated External Scan** → Stranger walking outside your house, checking weak windows/doors.  
- **Authenticated Internal Scan** → You invite a plumber inside, he checks every pipe, wall, and roof.  
- **Internal Scan** → You check problems inside your home.  
- **External Scan** → You check how strong your gate and locks are from outside.



## TL;DR
- Vulnerability scanning = finding weaknesses before hackers do.  
- Two main comparisons:  
  - **Authenticated vs Unauthenticated** → insider vs outsider view.  
  - **Internal vs External** → inside vs outside network.  
- After scanning → apply patches (fixes).  
---
# Popular Vulnerability Scanners 

Organizations use **automated vulnerability scanners** to find weaknesses faster.  
Each tool has its own features, deployment style, and strengths. Let’s break them down 👇



## 1. Nessus 🟢
- **History**: Started in 1998 (open-source). Acquired by **Tenable** in 2005 → became proprietary.
- **Deployment**: On-premises (you install & manage it yourself).
- **Versions**:
  - Free = limited features.
  - Paid = advanced scans, unlimited scans, professional support.
- **Best for**: Large enterprises needing detailed, customizable scans.

👉 Think: *Strong but managed locally. Like keeping a powerful watchdog inside your house.* 🏠



## 2. Qualys 🔵
- **History**: Founded in 1999.
- **Deployment**: Cloud-based SaaS (no hardware cost, no local management).
- **Features**:
  - Continuous vulnerability scanning.
  - Compliance checks + asset management.
  - Automatic alerts when vulnerabilities are detected.
- **Best for**: Companies that want *scanning without managing servers*.

👉 Think: *Like hiring a 24/7 online security guard service.* ☁️👮



## 3. Nexpose 🟠
- **History**: Developed by **Rapid7** in 2005.
- **Deployment**: On-premises + hybrid (mix of cloud + on-premises).
- **Features**:
  - Automatically discovers new devices/assets in network.
  - Provides **risk scores** (based on asset value + vulnerability impact).
  - Compliance checks available.
- **Best for**: Organizations that want both **asset discovery + scanning**.

👉 Think: *Like a guard who not only watches but also keeps a register of all visitors + their risk level.* 📋



## 4. OpenVAS 🟣
- **History**: Open-source tool by **Greenbone Security**.
- **Deployment**: On-premises (free).
- **Features**:
  - Scans known vulnerabilities using its database.
  - Less extensive than commercial tools.
  - Great for **small organizations & individuals**.
- **Best for**: Students, beginners, or small businesses with limited budgets.

👉 Think: *Free but basic guard — not the strongest, but useful for practice and small needs.* 🆓



## Comparison Table

| Tool       | Deployment        | Cost       | Features Level         | Best For                        |
|------------|------------------|------------|------------------------|---------------------------------|
| **Nessus** | On-premises       | Free + Paid | Very extensive         | Large enterprises               |
| **Qualys** | Cloud-based       | Subscription | Continuous scanning + compliance | Companies preferring SaaS |
| **Nexpose**| On-prem + Hybrid  | Subscription | Risk scores + asset discovery | Enterprises, compliance needs |
| **OpenVAS**| On-premises (open-source) | Free | Basic features         | Small orgs, students            |



## Reports 📑
- All scanners generate reports after each scan.  
- Reports include:
  - List of vulnerabilities found.
  - Risk scores (Low, Medium, High, Critical).
  - Detailed descriptions.
- Advanced scanners (like Nessus, Qualys, Nexpose) also:
  - Suggest **fixes/remediation methods**.
  - Allow exporting reports (PDF, CSV, etc.).



## TL;DR
- **Nessus** → Powerful, enterprise-level, on-premises.  
- **Qualys** → Cloud-based, easy, continuous monitoring.  
- **Nexpose** → Asset discovery + scanning, hybrid support.  
- **OpenVAS** → Free, open-source, good for beginners.  
---
# CVE and CVSS 

Imagine you are sitting at the **help desk** in an IT office.  
Every day, hundreds of clients raise complaints. To manage them properly:

- Each **complaint gets a unique number** → so you can track it easily.  
- Each **complaint gets a severity score** → so you know which one to fix first.  

This is exactly how **CVE and CVSS** work for cybersecurity vulnerabilities. 👇



## 🔹 CVE (Common Vulnerabilities and Exposures)

- **What it is**: A unique ID number assigned to each discovered vulnerability.  
- **Who made it**: Developed by **MITRE Corporation**.  
- **Purpose**: To publicly catalog vulnerabilities so security teams can track and fix them.  
- **Format**:  
  - Prefix = `CVE`  
  - Year = when it was discovered  
  - Digits = unique number  

👉 Example: `CVE-2024-9374`  
- `CVE` → prefix  
- `2024` → year of discovery  
- `9374` → unique ID  

👉 Think: *Like a ticket number for a client complaint.* 📝



## 🔹 CVSS (Common Vulnerability Scoring System)

- **What it is**: A scoring system that rates **how severe a vulnerability is**.  
- **Range**: 0.0 → 10.0 (higher = more dangerous).  
- **Why it matters**: Helps prioritize which vulnerabilities should be fixed first.  

👉 Think: *Like assigning urgency levels to complaints (low, medium, high, critical).* 🚨



## 📊 CVSS Score to Severity Levels

| CVSS Score Range | Severity Level |
|------------------|----------------|
| 0.0 – 3.9        | Low            |
| 4.0 – 6.9        | Medium         |
| 7.0 – 8.9        | High           |
| 9.0 – 10.0       | Critical       |



## ✅ Quick Analogy Recap

- **CVE** = *Complaint Number* (helps you identify the issue).  
- **CVSS** = *Severity Level* (helps you know how urgent it is).  

👉 Example:  
- Complaint: *“Wi-Fi not working”* → Ticket ID: #45 → Priority: High.  
- Vulnerability: *“Bug in Apache server”* → CVE-2024-9374 → CVSS: 9.8 (Critical).  
---
# OpenVAS Vulnerability Scanning 

We are now learning how to perform vulnerability scans using **OpenVAS**, an open-source vulnerability scanner.



## 🔹 Step 1: Installation (via Docker)

Installing OpenVAS directly can be **hectic** (too many dependencies).  
That’s why we use **Docker** → it packs everything into a container.

1. Install Docker:
  ```
 sudo apt install docker.io
```
2. Run OpenVAS container (from Immauss image):
 ```
  sudo docker run -d -p 443:443 --name openvas immauss/openvas
```      
👉 This command:
- `-d` = run in background (detached mode).  
- `-p 443:443` = maps container’s port 443 to local port 443 (for HTTPS).  
- `--name openvas` = names the container “openvas”.  
- `immauss/openvas` = Docker image with OpenVAS pre-configured.



## 🔹 Step 2: Accessing OpenVAS

- Open browser → type:
  https://127.0.0.1

- Login with credentials → You will see the **OpenVAS Dashboard**.

👉 Dashboard shows scan status, history, and results.



## 🔹 Step 3: Creating a Scan Task

1. From Dashboard → Click **Scans → Tasks**.  
   (Initially, no tasks will appear).

2. Click the **Star Icon → New Task**.

3. Fill in:
   - **Task Name** (any name you want).  
   - **Scan Target** → Add target details.


## 🔹 Step 4: Adding a Target

1. Enter:
   - **Target Name** (ex: “Test Machine”).  
   - **IP Address** of the machine to scan.  
   - Save by clicking **Create**.

2. Choose **Scan Options** (types of scan available).  
   - Example: Full & Fast Scan, Host Discovery, etc.  
   - Pick according to your requirement.

3. Click **Create**.



## 🔹 Step 5: Running the Scan

- In the Tasks Dashboard → Click the **Play Button** under “Actions”.  
- The scan starts running.  
- Wait a few minutes → Status will change to **Done** once complete.



## 🔹 Step 6: Viewing Results

- Dashboard will show **numbers** for vulnerabilities found (with severity).  
- Click on the **Task Name** → to see scan details.  
- Click on the **Vulnerability Count Number** → full list of vulnerabilities.  
- Each vulnerability entry gives:
  - Description.  
  - Severity (Low, Medium, High, Critical).  
  - Technical details.



## 📊 Summary Workflow

1. Install OpenVAS (via Docker).  
2. Access dashboard at `https://127.0.0.1`.  
3. Create a new **Task**.  
4. Add **Target Machine + IP**.  
5. Choose **Scan Type**.  
6. Run the scan.  
7. View results + severity details.  



## ✅ Why OpenVAS?
- Free + open-source.  
- Good for small orgs, individuals, or labs.  
- Provides detailed reports of vulnerabilities.  
